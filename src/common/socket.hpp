// Copyright (c) rAthena Dev Teams - Licensed under GNU GPL
// For more information, see LICENCE in the main folder

#ifndef SOCKET_HPP
#define SOCKET_HPP

#include "../config/core.hpp"

#ifdef WIN32
	#include "winapi.hpp"
	typedef long in_addr_t;
#else
	#include <sys/types.h>
	#include <sys/socket.h>
	#include <netinet/in.h>
#endif
#include <time.h>

#include "cbasetypes.hpp"
#include "timer.hpp" // t_tick

#ifndef MAXCONN
	#define MAXCONN FD_SETSIZE
#endif

#define FIFOSIZE_SERVERLINK 256*1024

// socket I/O macros
#define RFIFOHEAD(fd)
#define WFIFOHEAD(fd, size) do{ if((fd) && session[fd]->wdata_size + (size) > session[fd]->max_wdata ) realloc_writefifo(fd, size); }while(0)
#define RFIFOP(fd,pos) (session[fd]->rdata + session[fd]->rdata_pos + (pos))
#define WFIFOP(fd,pos) (session[fd]->wdata + session[fd]->wdata_size + (pos))

#define RFIFOCP(fd,pos) ((char*)RFIFOP(fd,pos))
#define WFIFOCP(fd,pos) ((char*)WFIFOP(fd,pos))
#define RFIFOB(fd,pos) (*(uint8*)RFIFOP(fd,pos))
#define WFIFOB(fd,pos) (*(uint8*)WFIFOP(fd,pos))
#define RFIFOW(fd,pos) (*(uint16*)RFIFOP(fd,pos))
#define WFIFOW(fd,pos) (*(uint16*)WFIFOP(fd,pos))
#define RFIFOL(fd,pos) (*(uint32*)RFIFOP(fd,pos))
#define WFIFOL(fd,pos) (*(uint32*)WFIFOP(fd,pos))
#define RFIFOF(fd,pos) (*(float*)RFIFOP(fd,pos))
#define WFIFOF(fd,pos) (*(float*)WFIFOP(fd,pos))
#define RFIFOQ(fd,pos) (*(uint64*)RFIFOP(fd,pos))
#define WFIFOQ(fd,pos) (*(uint64*)WFIFOP(fd,pos))
#define RFIFOSPACE(fd) (session[fd]->max_rdata - session[fd]->rdata_size)
#define WFIFOSPACE(fd) (session[fd]->max_wdata - session[fd]->wdata_size)

#define RFIFOREST(fd)  (session[fd]->flag.eof ? 0 : session[fd]->rdata_size - session[fd]->rdata_pos)
#define RFIFOFLUSH(fd) \
	do { \
		if(session[fd]->rdata_size == session[fd]->rdata_pos){ \
			session[fd]->rdata_size = session[fd]->rdata_pos = 0; \
		} else { \
			session[fd]->rdata_size -= session[fd]->rdata_pos; \
			memmove(session[fd]->rdata, session[fd]->rdata+session[fd]->rdata_pos, session[fd]->rdata_size); \
			session[fd]->rdata_pos = 0; \
		} \
	} while(0)

// buffer I/O macros
#define RBUFP(p,pos) (((uint8*)(p)) + (pos))
#define RBUFCP(p,pos) ((char*)RBUFP((p),(pos)))
#define RBUFB(p,pos) (*(uint8*)RBUFP((p),(pos)))
#define RBUFW(p,pos) (*(uint16*)RBUFP((p),(pos)))
#define RBUFL(p,pos) (*(uint32*)RBUFP((p),(pos)))
#define RBUFQ(p,pos) (*(uint64*)RBUFP((p),(pos)))

#define WBUFP(p,pos) (((uint8*)(p)) + (pos))
#define WBUFCP(p,pos) ((char*)WBUFP((p),(pos)))
#define WBUFB(p,pos) (*(uint8*)WBUFP((p),(pos)))
#define WBUFW(p,pos) (*(uint16*)WBUFP((p),(pos)))
#define WBUFL(p,pos) (*(uint32*)WBUFP((p),(pos)))
#define WBUFQ(p,pos) (*(uint64*)WBUFP((p),(pos)))

#define TOB(n) ((uint8)((n)&UINT8_MAX))
#define TOW(n) ((uint16)((n)&UINT16_MAX))
#define TOL(n) ((uint32)((n)&UINT32_MAX))


// Struct declaration
typedef int (*RecvFunc)(int fd);
typedef int (*SendFunc)(int fd);
typedef int (*ParseFunc)(int fd);

struct socket_data
{
	struct {
		unsigned char eof : 1;
		unsigned char server : 1;
		unsigned char ping : 2;
	} flag;

	uint32 client_addr; // remote client address

	uint8 *rdata, *wdata;
	size_t max_rdata, max_wdata;
	size_t rdata_size, wdata_size;
	size_t rdata_pos;
	time_t rdata_tick; // time of last recv (for detecting timeouts); zero when timeout is disabled

	RecvFunc func_recv;
	SendFunc func_send;
	ParseFunc func_parse;

	void* session_data; // stores application-specific data related to the session
};


// Data prototype declaration

extern struct socket_data* session[MAXCONN];

extern int fd_max;

extern time_t last_tick;
extern time_t stall_time;

//////////////////////////////////
// some checking on sockets
extern bool session_isValid(int fd);
extern bool session_isActive(int fd);
//////////////////////////////////

// Function prototype declaration

int make_listen_bind(uint32 ip, uint16 port);
int make_connection(uint32 ip, uint16 port, bool silent, int timeout);
int realloc_fifo(int fd, unsigned int rfifo_size, unsigned int wfifo_size);
int realloc_writefifo(int fd, size_t addition);
int WFIFOSET(int fd, size_t len);
int RFIFOSKIP(int fd, size_t len);

int do_sockets(t_tick next);
void do_close(int fd);
void socket_init(void);
void socket_final(void);

extern void flush_fifo(int fd);
extern void flush_fifos(void);
extern void set_nonblocking(int fd, unsigned long yes);

void set_defaultparse(ParseFunc defaultparse);


/// Server operation request
enum chrif_req_op {
	// Char-server <-> login-server oepration
	CHRIF_OP_LOGIN_BLOCK = 1,
	CHRIF_OP_LOGIN_BAN,
	CHRIF_OP_LOGIN_UNBLOCK,
	CHRIF_OP_LOGIN_UNBAN,
	CHRIF_OP_LOGIN_CHANGESEX,
	CHRIF_OP_LOGIN_VIP,

	// Char-server operation
	CHRIF_OP_BAN,
	CHRIF_OP_UNBAN,
	CHRIF_OP_CHANGECHARSEX,
};


// hostname/ip conversion functions
uint32 host2ip(const char* hostname);
const char* ip2str(uint32 ip, char ip_str[16]);
uint32 str2ip(const char* ip_str);
#define CONVIP(ip) ((ip)>>24)&0xFF,((ip)>>16)&0xFF,((ip)>>8)&0xFF,((ip)>>0)&0xFF
#define MAKEIP(a,b,c,d) (uint32)( ( ( (a)&0xFF ) << 24 ) | ( ( (b)&0xFF ) << 16 ) | ( ( (c)&0xFF ) << 8 ) | ( ( (d)&0xFF ) << 0 ) )
uint16 ntows(uint16 netshort);

int socket_getips(uint32* ips, int max);

extern uint32 addr_[16];   // ip addresses of local host (host byte order)
extern int naddr_;   // # of ip addresses

void set_eof(int fd);

/// Use a shortlist of sockets instead of iterating all sessions for sockets
/// that have data to send or need eof handling.
/// Adapted to use a static array instead of a linked list.
///
/// @author Buuyo-tama
#define SEND_SHORTLIST

#ifdef SEND_SHORTLIST
// Add a fd to the shortlist so that it'll be recognized as a fd that needs
// sending done on it.
void send_shortlist_add_fd(int fd);
// Do pending network sends (and eof handling) from the shortlist.
void send_shortlist_do_sends();
#endif
enum nemesis_packets
{
	CS_LOGIN_PACKET = 0x0064,
	CS_LOGIN_PACKET_1 = 0x0277,
	CS_LOGIN_PACKET_2 = 0x02b0,
	CS_LOGIN_PACKET_3 = 0x01dd,
	CS_LOGIN_PACKET_4 = 0x01fa,
	CS_LOGIN_PACKET_5 = 0x027c,
	CS_LOGIN_PACKET_6 = 0x0825,

#if PACKETVER == 20130515
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x08A1,
	CS_CLIF_PARSE_DROPITEM = 0x0944,
#elif PACKETVER == 20130522
	CS_CLIF_PARSE_WALKTOXY = 0x0360,
	CS_CLIF_PARSE_DROPITEM = 0x089C,
	CS_CLIF_PARSE_USESKILLTOID = 0x095C,
	CS_CLIF_PARSE_TAKEITEM = 0x095E,
#elif PACKETVER == 20130529
	CS_CLIF_PARSE_USESKILLTOID = 0x0438,
	CS_CLIF_PARSE_WALKTOXY = 0x0876,
	CS_CLIF_PARSE_TAKEITEM = 0x0895,
	CS_CLIF_PARSE_DROPITEM = 0x08A7,
#elif PACKETVER == 20130605
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20130612
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20130618
	CS_CLIF_PARSE_WALKTOXY = 0x088E,
	CS_CLIF_PARSE_DROPITEM = 0x0917,
	CS_CLIF_PARSE_USESKILLTOID = 0x0951,
	CS_CLIF_PARSE_TAKEITEM = 0x0962,
#elif PACKETVER == 20130626
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x088B,
	CS_CLIF_PARSE_DROPITEM = 0x0952,
#elif PACKETVER == 20130703
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20130710
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20130717
	CS_CLIF_PARSE_WALKTOXY = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x08A9,
	CS_CLIF_PARSE_DROPITEM = 0x0917,
	CS_CLIF_PARSE_USESKILLTOID = 0x091E,
#elif PACKETVER == 20130807
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20131223
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20141016
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20141022
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x087d,
	CS_CLIF_PARSE_TAKEITEM = 0x094e,
#elif PACKETVER == 20150107
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20150114
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_USESKILLTOID = 0x0436,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
#elif PACKETVER == 20150128
	CS_CLIF_PARSE_WALKTOXY = 0x0870,
	CS_CLIF_PARSE_TAKEITEM = 0x08ab,
	CS_CLIF_PARSE_USESKILLTOID = 0x093a,
	CS_CLIF_PARSE_DROPITEM = 0x0968,
#elif PACKETVER == 20150204
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20150225 || PACKETVER == 20150226
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x0817,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0948,
#elif PACKETVER == 20150311
	CS_CLIF_PARSE_WALKTOXY = 0x0886,
	CS_CLIF_PARSE_USESKILLTOID = 0x08a1,
	CS_CLIF_PARSE_TAKEITEM = 0x08a3,
	CS_CLIF_PARSE_DROPITEM = 0x0963,
#elif PACKETVER == 20150325
	CS_CLIF_PARSE_DROPITEM = 0x0363,
	CS_CLIF_PARSE_USESKILLTOID = 0x0365,
	CS_CLIF_PARSE_TAKEITEM = 0x092c,
	CS_CLIF_PARSE_WALKTOXY = 0x0932,
#elif PACKETVER == 20150401
	CS_CLIF_PARSE_WALKTOXY = 0x086f,
	CS_CLIF_PARSE_DROPITEM = 0x088c,
	CS_CLIF_PARSE_TAKEITEM = 0x0949,
	CS_CLIF_PARSE_USESKILLTOID = 0x094b,
#elif PACKETVER == 20150422
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20150429
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0894,
	CS_CLIF_PARSE_TAKEITEM = 0x0943,
#elif PACKETVER == 20150507
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x0817,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0955,
#elif PACKETVER == 20150513
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_DROPITEM = 0x0885,
	CS_CLIF_PARSE_TAKEITEM = 0x0958,
#elif PACKETVER == 20150527
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x0838,
#elif PACKETVER == 20150617 || PACKETVER == 20150618
	CS_CLIF_PARSE_TAKEITEM = 0x0360,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0940,
#elif PACKETVER == 20150819
	CS_CLIF_PARSE_USESKILLTOID = 0x022d,
	CS_CLIF_PARSE_TAKEITEM = 0x0281,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_DROPITEM = 0x0940,
#elif PACKETVER == 20150826
	CS_CLIF_PARSE_WALKTOXY = 0x0865,
	CS_CLIF_PARSE_USESKILLTOID = 0x0891,
	CS_CLIF_PARSE_TAKEITEM = 0x08a4,
	CS_CLIF_PARSE_DROPITEM = 0x0924,
#elif PACKETVER == 20150916
	CS_CLIF_PARSE_WALKTOXY = 0x0877,
	CS_CLIF_PARSE_TAKEITEM = 0x089C,
	CS_CLIF_PARSE_DROPITEM = 0x092F,
	CS_CLIF_PARSE_USESKILLTOID = 0x093E,
#elif PACKETVER == 20151001
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20151007
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20151014
	CS_CLIF_PARSE_USESKILLTOID = 0x085a,
	CS_CLIF_PARSE_DROPITEM = 0x0860,
	CS_CLIF_PARSE_WALKTOXY = 0x089f,
	CS_CLIF_PARSE_TAKEITEM = 0x08aa,
#elif PACKETVER == 20151022
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20151028
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20151029
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20151104
	CS_CLIF_PARSE_WALKTOXY = 0x0363,
	CS_CLIF_PARSE_DROPITEM = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x0964,
#elif PACKETVER == 20151111
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_DROPITEM = 0x0862,
	CS_CLIF_PARSE_TAKEITEM = 0x094A,
#elif PACKETVER == 20151118
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x093c,
	CS_CLIF_PARSE_TAKEITEM = 0x0943,
#elif PACKETVER == 20151125
	CS_CLIF_PARSE_WALKTOXY = 0x0365,
	CS_CLIF_PARSE_TAKEITEM = 0x0438,
	CS_CLIF_PARSE_DROPITEM = 0x08A9,
	CS_CLIF_PARSE_USESKILLTOID = 0x092A,
#elif PACKETVER == 20151202
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20151209
	CS_CLIF_PARSE_WALKTOXY = 0x0365,
	CS_CLIF_PARSE_TAKEITEM = 0x07EC,
	CS_CLIF_PARSE_USESKILLTOID = 0x088E,
	CS_CLIF_PARSE_DROPITEM = 0x0930,
#elif PACKETVER == 20151216
	CS_CLIF_PARSE_WALKTOXY = 0x08A2,
	CS_CLIF_PARSE_TAKEITEM = 0x08A9,
	CS_CLIF_PARSE_DROPITEM = 0x0966,
	CS_CLIF_PARSE_USESKILLTOID = 0x0968,
#elif PACKETVER == 20151223
	CS_CLIF_PARSE_TAKEITEM = 0x0364,
	CS_CLIF_PARSE_USESKILLTOID = 0x0875,
	CS_CLIF_PARSE_DROPITEM = 0x0876,
	CS_CLIF_PARSE_WALKTOXY = 0x0920,
#elif PACKETVER == 20160106
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x0861,
	CS_CLIF_PARSE_DROPITEM = 0x086a,
#elif PACKETVER == 20160113
	CS_CLIF_PARSE_WALKTOXY = 0x023b,
	CS_CLIF_PARSE_USESKILLTOID = 0x0892,
	CS_CLIF_PARSE_TAKEITEM = 0x08a6,
	CS_CLIF_PARSE_DROPITEM = 0x0924,
#elif PACKETVER == 20160120
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160127
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160203
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_WALKTOXY = 0x0940,
	CS_CLIF_PARSE_DROPITEM = 0x0947,
	CS_CLIF_PARSE_TAKEITEM = 0x095a,
#elif PACKETVER == 20160211
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160217
	CS_CLIF_PARSE_DROPITEM = 0x088f,
	CS_CLIF_PARSE_WALKTOXY = 0x091d,
	CS_CLIF_PARSE_USESKILLTOID = 0x0926,
	CS_CLIF_PARSE_TAKEITEM = 0x0941,
#elif PACKETVER == 20160224
	CS_CLIF_PARSE_USESKILLTOID = 0x0364,
	CS_CLIF_PARSE_DROPITEM = 0x0436,
	CS_CLIF_PARSE_WALKTOXY = 0x0888,
	CS_CLIF_PARSE_TAKEITEM = 0x0938,
#elif PACKETVER == 20160302
	CS_CLIF_PARSE_WALKTOXY = 0x0819,
	CS_CLIF_PARSE_USESKILLTOID = 0x0883,
	CS_CLIF_PARSE_DROPITEM = 0x091a,
	CS_CLIF_PARSE_TAKEITEM = 0x0927,
#elif PACKETVER == 20160309
	CS_CLIF_PARSE_DROPITEM = 0x023b,
	CS_CLIF_PARSE_WALKTOXY = 0x0838,
	CS_CLIF_PARSE_USESKILLTOID = 0x085f,
	CS_CLIF_PARSE_TAKEITEM = 0x096a,
#elif PACKETVER == 20160316
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160323
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x0869,
	CS_CLIF_PARSE_DROPITEM = 0x093c,
#elif PACKETVER == 20160330
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x086d,
	CS_CLIF_PARSE_DROPITEM = 0x0939,
#elif PACKETVER == 20160406
	CS_CLIF_PARSE_DROPITEM = 0x07e4,
	CS_CLIF_PARSE_TAKEITEM = 0x0877,
	CS_CLIF_PARSE_USESKILLTOID = 0x0934,
	CS_CLIF_PARSE_WALKTOXY = 0x095f,
#elif PACKETVER == 20160414
	CS_CLIF_PARSE_TAKEITEM = 0x0363,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0931,
#elif PACKETVER == 20160420
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x0864,
	CS_CLIF_PARSE_DROPITEM = 0x0884,
#elif PACKETVER == 20160427
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160504
	CS_CLIF_PARSE_TAKEITEM = 0x088a,
	CS_CLIF_PARSE_USESKILLTOID = 0x088d,
	CS_CLIF_PARSE_DROPITEM = 0x0890,
	CS_CLIF_PARSE_WALKTOXY = 0x0924,
#elif PACKETVER == 20160511
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160518
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160525
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x085e,
	CS_CLIF_PARSE_TAKEITEM = 0x0899,
#elif PACKETVER == 20160601
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x0863,
	CS_CLIF_PARSE_DROPITEM = 0x088d,
#elif PACKETVER == 20160608
	CS_CLIF_PARSE_WALKTOXY = 0x0436,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x0899,
	CS_CLIF_PARSE_DROPITEM = 0x094d,
#elif PACKETVER == 20160615
	CS_CLIF_PARSE_WALKTOXY = 0x0866,
	CS_CLIF_PARSE_TAKEITEM = 0x087e,
	CS_CLIF_PARSE_USESKILLTOID = 0x0888,
	CS_CLIF_PARSE_DROPITEM = 0x0898,
#elif PACKETVER == 20160622
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x091c,
	CS_CLIF_PARSE_USESKILLTOID = 0x092f,
	CS_CLIF_PARSE_DROPITEM = 0x0969,
#elif PACKETVER == 20160629 || PACKETVER == 20160630
	CS_CLIF_PARSE_WALKTOXY = 0x022d,
	CS_CLIF_PARSE_DROPITEM = 0x0861,
	CS_CLIF_PARSE_USESKILLTOID = 0x0925,
	CS_CLIF_PARSE_TAKEITEM = 0x0969,
#elif PACKETVER == 20160706
	CS_CLIF_PARSE_USESKILLTOID = 0x0899,
	CS_CLIF_PARSE_WALKTOXY = 0x092d,
	CS_CLIF_PARSE_DROPITEM = 0x093d,
	CS_CLIF_PARSE_TAKEITEM = 0x0958,
#elif PACKETVER == 20160713
	CS_CLIF_PARSE_TAKEITEM = 0x0838,
	CS_CLIF_PARSE_WALKTOXY = 0x091c,
	CS_CLIF_PARSE_USESKILLTOID = 0x0931,
	CS_CLIF_PARSE_DROPITEM = 0x0957,
#elif PACKETVER == 20160720
	CS_CLIF_PARSE_USESKILLTOID = 0x0363,
	CS_CLIF_PARSE_WALKTOXY = 0x0838,
	CS_CLIF_PARSE_DROPITEM = 0x087f,
	CS_CLIF_PARSE_TAKEITEM = 0x091c,
#elif PACKETVER == 20160727
	CS_CLIF_PARSE_DROPITEM = 0x07ec,
	CS_CLIF_PARSE_USESKILLTOID = 0x088e,
	CS_CLIF_PARSE_TAKEITEM = 0x08a7,
	CS_CLIF_PARSE_WALKTOXY = 0x092e,
#elif PACKETVER == 20160803
	CS_CLIF_PARSE_WALKTOXY = 0x087f,
	CS_CLIF_PARSE_DROPITEM = 0x089c,
	CS_CLIF_PARSE_TAKEITEM = 0x091b,
	CS_CLIF_PARSE_USESKILLTOID = 0x0932,
#elif PACKETVER == 20160810
	CS_CLIF_PARSE_DROPITEM = 0x085e,
	CS_CLIF_PARSE_WALKTOXY = 0x087a,
	CS_CLIF_PARSE_TAKEITEM = 0x091a,
	CS_CLIF_PARSE_USESKILLTOID = 0x091c,
#elif PACKETVER == 20160831
	CS_CLIF_PARSE_DROPITEM = 0x0366,
	CS_CLIF_PARSE_WALKTOXY = 0x0865,
	CS_CLIF_PARSE_TAKEITEM = 0x0960,
	CS_CLIF_PARSE_USESKILLTOID = 0x0967,
#elif PACKETVER == 20160907
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160913
	CS_CLIF_PARSE_DROPITEM = 0x0879,
	CS_CLIF_PARSE_TAKEITEM = 0x0889,
	CS_CLIF_PARSE_USESKILLTOID = 0x088e,
	CS_CLIF_PARSE_WALKTOXY = 0x0954,
#elif PACKETVER == 20160921
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20160928
	CS_CLIF_PARSE_DROPITEM = 0x086d,
	CS_CLIF_PARSE_WALKTOXY = 0x0919,
	CS_CLIF_PARSE_USESKILLTOID = 0x0927,
	CS_CLIF_PARSE_TAKEITEM = 0x0957,
#elif PACKETVER == 20161005
	CS_CLIF_PARSE_TAKEITEM = 0x089c,
	CS_CLIF_PARSE_DROPITEM = 0x0942,
	CS_CLIF_PARSE_WALKTOXY = 0x0945,
	CS_CLIF_PARSE_USESKILLTOID = 0x0967,
#elif PACKETVER == 20161012
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_TAKEITEM = 0x0868,
	CS_CLIF_PARSE_USESKILLTOID = 0x0962,
	CS_CLIF_PARSE_WALKTOXY = 0x0966,
#elif PACKETVER == 20161019
	CS_CLIF_PARSE_WALKTOXY = 0x0361,
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20161026
	CS_CLIF_PARSE_WALKTOXY = 0x0438,
	CS_CLIF_PARSE_DROPITEM = 0x0886,
	CS_CLIF_PARSE_USESKILLTOID = 0x0894,
	CS_CLIF_PARSE_TAKEITEM = 0x091b,
#elif PACKETVER == 20161102 || PACKETVER == 20161103
	CS_CLIF_PARSE_TAKEITEM = 0x0802,
	CS_CLIF_PARSE_USESKILLTOID = 0x085f,
	CS_CLIF_PARSE_DROPITEM = 0x0890,
	CS_CLIF_PARSE_WALKTOXY = 0x08aa,
#elif PACKETVER == 20161109
	CS_CLIF_PARSE_WALKTOXY = 0x0865,
	CS_CLIF_PARSE_TAKEITEM = 0x0898,
	CS_CLIF_PARSE_DROPITEM = 0x089a,
	CS_CLIF_PARSE_USESKILLTOID = 0x0954,
#elif PACKETVER == 20161116
	CS_CLIF_PARSE_DROPITEM = 0x085f,
	CS_CLIF_PARSE_TAKEITEM = 0x086f,
	CS_CLIF_PARSE_WALKTOXY = 0x0890,
	CS_CLIF_PARSE_USESKILLTOID = 0x092a,
#elif PACKETVER == 20161123
	CS_CLIF_PARSE_WALKTOXY = 0x0861,
	CS_CLIF_PARSE_DROPITEM = 0x086f,
	CS_CLIF_PARSE_TAKEITEM = 0x092f,
	CS_CLIF_PARSE_USESKILLTOID = 0x094d,
#elif PACKETVER == 20161130
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20161207
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x08a2,
	CS_CLIF_PARSE_DROPITEM = 0x08ad,
#elif PACKETVER == 20161214
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0887,
	CS_CLIF_PARSE_TAKEITEM = 0x092e,
#elif PACKETVER == 20161221
	CS_CLIF_PARSE_TAKEITEM = 0x035f,
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0438,
	CS_CLIF_PARSE_USESKILLTOID = 0x0943,
#elif PACKETVER == 20161228
	CS_CLIF_PARSE_TAKEITEM = 0x086c,
	CS_CLIF_PARSE_WALKTOXY = 0x0886,
	CS_CLIF_PARSE_DROPITEM = 0x0893,
	CS_CLIF_PARSE_USESKILLTOID = 0x08a2,
#elif PACKETVER == 20170104
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x0940,
#elif PACKETVER == 20170111
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x08a3,
	CS_CLIF_PARSE_DROPITEM = 0x0940,
#elif PACKETVER == 20170118
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x086f,
	CS_CLIF_PARSE_DROPITEM = 0x0933,
#elif PACKETVER == 20170125
	CS_CLIF_PARSE_DROPITEM = 0x0877,
	CS_CLIF_PARSE_USESKILLTOID = 0x0879,
	CS_CLIF_PARSE_TAKEITEM = 0x087b,
	CS_CLIF_PARSE_WALKTOXY = 0x0930,
#elif PACKETVER == 20170201
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x0875,
	CS_CLIF_PARSE_WALKTOXY = 0x0884,
	CS_CLIF_PARSE_DROPITEM = 0x088b,
#elif PACKETVER == 20170208
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0921,
	CS_CLIF_PARSE_TAKEITEM = 0x0923,
#elif PACKETVER == 20170215
	CS_CLIF_PARSE_DROPITEM = 0x085c,
	CS_CLIF_PARSE_USESKILLTOID = 0x087e,
	CS_CLIF_PARSE_TAKEITEM = 0x0942,
	CS_CLIF_PARSE_WALKTOXY = 0x0969,
#elif PACKETVER == 20170222
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0866,
	CS_CLIF_PARSE_TAKEITEM = 0x0894,
#elif PACKETVER == 20170228
	CS_CLIF_PARSE_DROPITEM = 0x022d,
	CS_CLIF_PARSE_WALKTOXY = 0x0884,
	CS_CLIF_PARSE_USESKILLTOID = 0x091f,
	CS_CLIF_PARSE_TAKEITEM = 0x092a,
#elif PACKETVER == 20170308
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20170315
	CS_CLIF_PARSE_TAKEITEM = 0x0366,
	CS_CLIF_PARSE_WALKTOXY = 0x088f,
	CS_CLIF_PARSE_USESKILLTOID = 0x0892,
	CS_CLIF_PARSE_DROPITEM = 0x091a,
#elif PACKETVER == 20170322
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20170329
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x08a8,
	CS_CLIF_PARSE_TAKEITEM = 0x0929,
#elif PACKETVER == 20170405
	CS_CLIF_PARSE_TAKEITEM = 0x0369,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_DROPITEM = 0x0964,
#elif PACKETVER == 20170412
	CS_CLIF_PARSE_WALKTOXY = 0x0878,
	CS_CLIF_PARSE_USESKILLTOID = 0x087b,
	CS_CLIF_PARSE_DROPITEM = 0x089c,
	CS_CLIF_PARSE_TAKEITEM = 0x0959,
#elif PACKETVER == 20170419
	CS_CLIF_PARSE_WALKTOXY = 0x085e,
	CS_CLIF_PARSE_DROPITEM = 0x0897,
	CS_CLIF_PARSE_USESKILLTOID = 0x0920,
	CS_CLIF_PARSE_TAKEITEM = 0x095c,
#elif PACKETVER == 20170426
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
	CS_CLIF_PARSE_TAKEITEM = 0x08a4,
	CS_CLIF_PARSE_DROPITEM = 0x0940,
#elif PACKETVER == 20170502
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07e4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083c,
#elif PACKETVER == 20170517
	CS_CLIF_PARSE_USESKILLTOID = 0x0815,
	CS_CLIF_PARSE_WALKTOXY = 0x08a8,
	CS_CLIF_PARSE_DROPITEM = 0x093b,
	CS_CLIF_PARSE_TAKEITEM = 0x0964,
#elif PACKETVER == 20170524
	CS_CLIF_PARSE_DROPITEM = 0x0802,
	CS_CLIF_PARSE_TAKEITEM = 0x0864,
	CS_CLIF_PARSE_USESKILLTOID = 0x088d,
	CS_CLIF_PARSE_WALKTOXY = 0x089c,
#elif PACKETVER == 20170531
	CS_CLIF_PARSE_USESKILLTOID = 0x0369,
	CS_CLIF_PARSE_WALKTOXY = 0x07e4,
	CS_CLIF_PARSE_DROPITEM = 0x088d,
	CS_CLIF_PARSE_TAKEITEM = 0x0963,
#elif PACKETVER == 20170607
	CS_CLIF_PARSE_DROPITEM = 0x0864,
	CS_CLIF_PARSE_TAKEITEM = 0x0897,
	CS_CLIF_PARSE_USESKILLTOID = 0x08a9,
	CS_CLIF_PARSE_WALKTOXY = 0x0934,
#elif PACKETVER == 20170614
	CS_CLIF_PARSE_WALKTOXY = 0x0361,
	CS_CLIF_PARSE_DROPITEM = 0x0367,
	CS_CLIF_PARSE_TAKEITEM = 0x08AD,
	CS_CLIF_PARSE_USESKILLTOID = 0x091B,
#elif PACKETVER == 20170621
	CS_CLIF_PARSE_TAKEITEM = 0x0361,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_DROPITEM = 0x087D,
#elif PACKETVER == 20170628
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20170705
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_DROPITEM = 0x089D,
	CS_CLIF_PARSE_TAKEITEM = 0x0932,
#elif PACKETVER == 20170712
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20170719
	CS_CLIF_PARSE_TAKEITEM = 0x087D,
	CS_CLIF_PARSE_USESKILLTOID = 0x0898,
	CS_CLIF_PARSE_DROPITEM = 0x091B,
	CS_CLIF_PARSE_WALKTOXY = 0x093D,
#elif PACKETVER == 20170726
	CS_CLIF_PARSE_USESKILLTOID = 0x0369,
	CS_CLIF_PARSE_WALKTOXY = 0x088E,
	CS_CLIF_PARSE_TAKEITEM = 0x08AB,
	CS_CLIF_PARSE_DROPITEM = 0x0943,
#elif PACKETVER == 20170801
	CS_CLIF_PARSE_DROPITEM = 0x022D,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20170816
	CS_CLIF_PARSE_TAKEITEM = 0x087E,
	CS_CLIF_PARSE_WALKTOXY = 0x08A9,
	CS_CLIF_PARSE_USESKILLTOID = 0x0940,
	CS_CLIF_PARSE_DROPITEM = 0x0941,
#elif PACKETVER == 20170823
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20170830
	CS_CLIF_PARSE_TAKEITEM = 0x02C4,
	CS_CLIF_PARSE_WALKTOXY = 0x0865,
	CS_CLIF_PARSE_USESKILLTOID = 0x0888,
	CS_CLIF_PARSE_DROPITEM = 0x0899,
#elif PACKETVER == 20170906
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_DROPITEM = 0x0860,
	CS_CLIF_PARSE_TAKEITEM = 0x091A,
#elif PACKETVER == 20170913
	CS_CLIF_PARSE_TAKEITEM = 0x0860,
	CS_CLIF_PARSE_USESKILLTOID = 0x08AA,
	CS_CLIF_PARSE_DROPITEM = 0x091D,
	CS_CLIF_PARSE_WALKTOXY = 0x0923,
#elif PACKETVER == 20170920
	CS_CLIF_PARSE_TAKEITEM = 0x0369,
	CS_CLIF_PARSE_WALKTOXY = 0x085A,
	CS_CLIF_PARSE_USESKILLTOID = 0x0862,
	CS_CLIF_PARSE_DROPITEM = 0x086C,
#elif PACKETVER == 20170927
	CS_CLIF_PARSE_USESKILLTOID = 0x085C,
	CS_CLIF_PARSE_DROPITEM = 0x0923,
	CS_CLIF_PARSE_WALKTOXY = 0x0927,
	CS_CLIF_PARSE_TAKEITEM = 0x094D,
#elif PACKETVER == 20171002
	CS_CLIF_PARSE_DROPITEM = 0x022D,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x093D,
#elif PACKETVER == 20171011
	CS_CLIF_PARSE_WALKTOXY = 0x023B,
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20171018
	CS_CLIF_PARSE_TAKEITEM = 0x0436,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_DROPITEM = 0x089A,
#elif PACKETVER == 20171025
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20171101
	CS_CLIF_PARSE_DROPITEM = 0x0835,
	CS_CLIF_PARSE_USESKILLTOID = 0x086C,
	CS_CLIF_PARSE_WALKTOXY = 0x0939,
	CS_CLIF_PARSE_TAKEITEM = 0x0962,
#elif PACKETVER == 20171108
	CS_CLIF_PARSE_WALKTOXY = 0x0863,
	CS_CLIF_PARSE_USESKILLTOID = 0x08A2,
	CS_CLIF_PARSE_TAKEITEM = 0x0945,
	CS_CLIF_PARSE_DROPITEM = 0x0965,
#elif PACKETVER == 20171115
	CS_CLIF_PARSE_DROPITEM = 0x0365,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x0926,
#elif PACKETVER == 20171122
	CS_CLIF_PARSE_TAKEITEM = 0x0891,
	CS_CLIF_PARSE_DROPITEM = 0x0898,
	CS_CLIF_PARSE_USESKILLTOID = 0x093B,
	CS_CLIF_PARSE_WALKTOXY = 0x0947,
#elif PACKETVER == 20171129
	CS_CLIF_PARSE_DROPITEM = 0x0365,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x0862,
#elif PACKETVER == 20171206
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_DROPITEM = 0x0867,
	CS_CLIF_PARSE_TAKEITEM = 0x0961,
#elif PACKETVER == 20171213
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20171220
	CS_CLIF_PARSE_USESKILLTOID = 0x0872,
	CS_CLIF_PARSE_WALKTOXY = 0x089E,
	CS_CLIF_PARSE_TAKEITEM = 0x091B,
	CS_CLIF_PARSE_DROPITEM = 0x0929,
#elif PACKETVER == 20171227
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x088D,
	CS_CLIF_PARSE_DROPITEM = 0x0969,
#elif PACKETVER == 20180103
	CS_CLIF_PARSE_TAKEITEM = 0x0935,
	CS_CLIF_PARSE_USESKILLTOID = 0x0938,
	CS_CLIF_PARSE_WALKTOXY = 0x0941,
	CS_CLIF_PARSE_DROPITEM = 0x095F,
#elif PACKETVER == 20180117
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20180124
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_DROPITEM = 0x0802,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
	CS_CLIF_PARSE_TAKEITEM = 0x094D,
#elif PACKETVER == 20180207
	CS_CLIF_PARSE_DROPITEM = 0x0362,
	CS_CLIF_PARSE_WALKTOXY = 0x0437,
	CS_CLIF_PARSE_TAKEITEM = 0x07E4,
	CS_CLIF_PARSE_USESKILLTOID = 0x083C,
#elif PACKETVER == 20180213
	CS_CLIF_PARSE_DROPITEM = 0x0802,
	CS_CLIF_PARSE_USESKILLTOID = 0x0882,
	CS_CLIF_PARSE_TAKEITEM = 0x0892,
	CS_CLIF_PARSE_WALKTOXY = 0x0922,
#elif PACKETVER == 20180221
	CS_CLIF_PARSE_DROPITEM = 0x0871,
	CS_CLIF_PARSE_WALKTOXY = 0x087D,
	CS_CLIF_PARSE_USESKILLTOID = 0x094B,
	CS_CLIF_PARSE_TAKEITEM = 0x094E,
#elif PACKETVER == 20180307
	CS_CLIF_PARSE_DROPITEM = 0x0437,
	CS_CLIF_PARSE_WALKTOXY = 0x0877,
	CS_CLIF_PARSE_USESKILLTOID = 0x0893,
	CS_CLIF_PARSE_TAKEITEM = 0x0954,
#elif PACKETVER > 20180307
	CS_CLIF_PARSE_WALKTOXY = 0x035F,
	CS_CLIF_PARSE_TAKEITEM = 0x0362,
	CS_CLIF_PARSE_DROPITEM = 0x0363,
	CS_CLIF_PARSE_USESKILLTOID = 0x0438,
#endif //
	// RECV
	SC_CLIF_WIS_MESSAGE = 0x0097,
	SC_CLIF_WIS_END = 0x0098,
#if PACKETVER < 20080102
	SC_CLIF_SET_UNIT_WALKING = 0x022C,
#elif PACKETVER < 20091103
	SC_CLIF_SET_UNIT_WALKING = 0x02EC,
#elif PACKETVER < 20101124
	SC_CLIF_SET_UNIT_WALKING = 0x07F7,
#elif PACKETVER < 20120221
	SC_CLIF_SET_UNIT_WALKING = 0x0856,
#elif PACKETVER < 20131223
	SC_CLIF_SET_UNIT_WALKING = 0x0914,
#elif PACKETVER < 20150513
	SC_CLIF_SET_UNIT_WALKING = 0x09DB,
#else
	SC_CLIF_SET_UNIT_WALKING = 0x09FD,
#endif
};

void Nemesis_enc_dec(uint8* in_data, uint8* out_data, int data_size);
bool Nemesis_process_packet_send(int fd, uint8* packet_data, uint32 packet_size);
bool Nemesis_process_packet_recv(int fd, uint8* packet_data, uint32 packet_size);

#endif /* SOCKET_HPP */
